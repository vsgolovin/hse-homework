\problemset{Контрольная работа №1 (вариант 11)}

% 1
\begin{problem}
    Найти разложение полного ранга и псевдообратную матрицу для
    \begin{equation*}
        A =
        \begin{bmatrix}
            4 & -11 & -14\\
            -1 & 4 & 6\\
            3 & -8 & -10\\
            -2 & -7 & 10
        \end{bmatrix}
    \end{equation*}
\end{problem}


Для получения разложения полного ранга приведём матрицу $A$ к ступенчатому
виду.
\begin{equation*}
    A =
    \begin{bmatrix}
        4 & -11 & -14\\
        -1 & 4 & 6\\
        3 & -8 & -10\\
        -2 & -7 & 10
    \end{bmatrix}
    \sim
    \begin{bmatrix}
        1 & -11/4 & -14/4\\
        0 & 5/4 & 10/4\\
        0 & 1/4 & 1/2\\
        0 & -25/2 & 3
    \end{bmatrix}
    \sim
    \begin{bmatrix}
        1 & -2.75 & -3.5\\
        0 & 1 & 2\\
        0 & 1 & 2\\
        0 & 1 & -6/25
    \end{bmatrix}
    \sim
    \begin{bmatrix}
        1 & 0 & 0\\
        0 & 1 & 0\\
        0 & 0 & 0\\
        0 & 0 & 1
    \end{bmatrix}
\end{equation*}

Видим, что исходная матрица имеет полный столбцовый ранг, т.е. её разложение
полного ранга
\begin{equation*}
    A = F G = A I =
    \begin{bmatrix}
        4 & -11 & -14\\
        -1 & 4 & 6\\
        3 & -8 & -10\\
        -2 & -7 & 10
    \end{bmatrix}
    \cdot
    \begin{bmatrix}
        1 & 0 & 0\\
        0 & 1 & 0\\
        0 & 0 & 1
    \end{bmatrix},
\end{equation*}
а псевдообратная к ней матрица вычисляется как
$A^+ = (A^TA)^{-1}A^T$.

Итак,
\begin{equation*}
    A^T A =
    \begin{pmatrix}
        30 & -58 & -112\\
        -58 & 250 & 188\\
        -112 & 188 & 432
    \end{pmatrix},
\end{equation*}
найдём $(A^T A)^{-1}$:
\begin{multline*}
    \begin{pmatrix}
        30 & -58 & -112 &\bigm|& 1 & 0 & 0\\
        -58 & 250 & 188 &\bigm|& 0 & 1 & 0\\
        -112 & 188 & 432 &\bigm|& 0 & 0 & 1
    \end{pmatrix}
    \sim
    \begin{pmatrix}
        1 & -58/30 & -56/15 &\bigm|& 1/30 & 0 & 0\\
        0 & 5432/15 & -428/15 &\bigm|& 58/30 & 1 & 0\\
        0 & -428/15 & 208/15 &\bigm|& 56/15 & 0 & 1
    \end{pmatrix}
    \sim \\ \sim \ldots \sim
    \begin{pmatrix}
        1 & 0 & 0 &\bigm|& 2.2065 & 0.1215 & 0.5192\\
        0 & 0 & 0 &\bigm|& 0.1215 & 0.0126 & 0.0260\\
        0 & 0 & 1 &\bigm|& 0.5192 & 0.0260 & 0.1256
    \end{pmatrix}
\end{multline*}

Получим, что
\begin{equation*}
    A^+ = (A^T A)^{-1} A^T =
    \begin{pmatrix}
        0.2211 & 1.3946 & 0.4558 & -0.0714\\
        -0.0170 & 0.0850 & 0.0034 & -0.0714\\
        0.0323 & 0.3384 & 0.0935 & 0.0357
    \end{pmatrix}
\end{equation*}
 

% 2
\newpage
\begin{problem}
    Среди всех приближений решения следующей системы по методу наименьших
    квадратов найти решение наименьшей длины
    \begin{equation*}
        \begin{cases}
            -2x + 0y + 15z + 13t = 7\\
            4x + 6y - 12z + 10t = 0\\
            -1x + 1y + 9z + 11t = 2\\
            3x + 5y - 8z + 10t = 2
        \end{cases}
    \end{equation*}
\end{problem}

Обозначим
\begin{equation*}
    A =
    \begin{pmatrix}
        -2 & 0 & 15 & 13\\
        4 & 6 & -12 & 10\\
        -1 & 1 & 9 & 11\\
        3 & 5 & -8 & 10
    \end{pmatrix}
    ,\qquad
    b =
    \begin{pmatrix}
        7\\
        0\\
        2\\
        2
    \end{pmatrix},
\end{equation*}
тогда искомое решение $u = (x\; y\; z\; t)^T = A^+ b$.

Найдём $A^+$. Как и в предудущей задаче, сначала приведём матрицу к
ступенчатому виду:
\begin{equation*}
    A =
    \begin{pmatrix}
        -2 & 0 & 15 & 13\\
        4 & 6 & -12 & 10\\
        -1 & 1 & 9 & 11\\
        3 & 5 & -8 & 10
    \end{pmatrix}
    \sim
    \begin{pmatrix}
        1 & 0 & -7.5 & -6.5\\
        0 & 6 & 18 & 36\\
        0 & 1 & 1.5 & 4.5\\
        0 & 5 & 14.5 & 29.5
    \end{pmatrix}
    \sim
    \begin{pmatrix}
        1 & 0 & -7.5 & -6.5\\
        0 & 1 & 3 & 6\\
        0 & 0 & 1.5 & 1.5\\
        0 & 0 & 0.5 & 0.5
    \end{pmatrix}
    \sim
    \begin{pmatrix}
        1 & 0 & 0 & 1\\
        0 & 1 & 0 & 3\\
        0 & 0 & 1 & 1\\
        0 & 0 & 0 & 0
    \end{pmatrix}.
\end{equation*}

Теперь мы можем записать разложение полного ранга матрицы $A$
\begin{equation*}
    A = FG =
    \begin{pmatrix}
        -2 & 0 & 15\\
        4 & 6 & -12\\
        -1 & 1 & 9\\
        3 & 5 & -8
    \end{pmatrix}
    \cdot
    \begin{pmatrix}
        1 & 0 & 0 & 1\\
        0 & 1 & 0 & 3\\
        0 & 0 & 1 & 1
    \end{pmatrix}.
\end{equation*}

\begin{equation*}
    G^+ = G^T (G G^T)^{-1} = 
    \begin{pmatrix}
        1 & 0 & 0\\
        0 & 1 & 0\\
        0 & 0 & 1\\
        1 & 3 & 1
    \end{pmatrix}
    \cdot
    \begin{pmatrix}
        2 & 3 & 1\\
        3 & 10 & 3\\
        1 & 3 & 2
    \end{pmatrix}^{-1}
    =
    \begin{pmatrix}
        1 & 0 & 0\\
        0 & 1 & 0\\
        0 & 0 & 1\\
        1 & 3 & 1
    \end{pmatrix}
    \cdot
    \begin{pmatrix}
        11/12 & -1/4 & -1/12\\
        -1/4 & 1/4 & -1/4\\
        -1/12 & -1/4 & 11/12
    \end{pmatrix}
    =
    \frac{1}{12}
    \begin{pmatrix}
        11 & -3 & -1\\
        -3 & 3 & -3\\
        -1 & -3 & 11\\
        1 & 3 & 1
    \end{pmatrix}
\end{equation*}

\begin{equation*}
    F^+ = (F^T F)^{-1} F^T =
    \begin{pmatrix}
        30 & 38 & -111\\
        38 & 62 & -103\\
        -111 & -103 & 513
    \end{pmatrix}^{-1}
    \cdot
    \begin{pmatrix}
        -2 & 4 & -1 & 3\\
        0 & 6 & 1 & 5\\
        15 & -12 & 9 & -8
    \end{pmatrix}
    =
    \begin{pmatrix}
        3.5750 & 1.4750 & -4.7250 & -0.8250\\
        -1.2893 & -0.4750 & 1.8679 & 0.3964\\
        0.5429 & 0.2000 & -0.6286 & -0.1143
    \end{pmatrix}
\end{equation*}

\begin{equation*}
    A^+ = (FG)^+ = G^+ F^+ =
    \begin{pmatrix}
        3.554  & 1.454 & -4.746 & -0.846\\
        -1.3522 & -0.538 &  1.806 &  0.334\\
        0.522  & 0.179 & -0.649 & -0.135\\
        0.021  & 0.021 &  0.021 &  0.021
    \end{pmatrix}
\end{equation*}

\begin{equation*}
    u = A^+ b =
    \begin{pmatrix}
        3.554  & 1.454 & -4.746 & -0.846\\
        -1.3522 & -0.538 &  1.806 &  0.334\\
        0.522  & 0.179 & -0.649 & -0.135\\
        0.021  & 0.021 &  0.021 &  0.021
    \end{pmatrix}
    \cdot
    \begin{pmatrix}
        7\\
        0\\
        2\\
        2
    \end{pmatrix}
    =
    \begin{pmatrix}
        13.696\\
        -5.183\\
        2.085\\
        0.229
    \end{pmatrix}
\end{equation*}

% 3
\newpage
\begin{problem}
    Построить график и выписать интерполяционный многочлен Лагранжа для
    функции, проходящей через четыре точки, координаты которых образуют
    столбцы матрицы
    \begin{equation*}
        P =
        \begin{bmatrix}
            -2 & -1 & 0 & 1\\
            -10 & -10 & 16 & -20
        \end{bmatrix}
    \end{equation*}
\end{problem}

Интерполяционный многочлен Лагранжа $L(x)$ определяется следующим образом:
\begin{equation*}
    L(x) = \sum_{i=0}^{n}{l_i(x) y_i}, \qquad
    l_i(x) = \prod_{
        \substack{0 \leq j \leq n\\i \neq j}
    }{
        \frac{x - x_j}{x_i - x_j}
    }.
\end{equation*}

Итак, коэффициенты разложения:
\begin{equation*}
    l_0(x) = \frac{(x + 1)x(x - 1)}{(-2 + 1)(-2 - 0)(-2 - 1)} =
    \frac{x(x^2 - 1)}{-6}
\end{equation*}
\begin{equation*}
    l_1(x) = \frac{(x + 2)x(x-1)}{(-1 + 2)(-1)(-1 - 1)} =
    \frac{x(x-1)(x+2)}{2}
\end{equation*}
\begin{equation*}
    l_2(x) = \frac{(x + 2)(x + 1)(x - 1)}{2 \cdot 1 \cdot (-1)} =
    \frac{(x^2-1)(x+2)}{-2}
\end{equation*}
\begin{equation*}
    l_3(x) = \frac{(x + 2)(x + 1) x}{(1 + 2)(1 + 1)(1 - 0)} =
    \frac{x(x+1)(x+2)}{6}
\end{equation*}

Подставив эти коэффициенты в формулу для $L(x)$, и упростив выражение, получим
\begin{equation*}
    L(x) = -\frac{44}{3}x^3 - 31x^2 + \frac{29}{3}x + 16.
\end{equation*}

\begin{figure}[hbt]
    \centering
    \includegraphics*[scale=1.0]{./figures/ex3.pdf}
    \caption{Интерполяционный многочлен Лагранжа}
\end{figure}

% 4
\newpage
\begin{problem}
    Построить график и найти (параметрически) уравнение кривой Безье, заданной
    четырьмя точками, координаты которых образуют столбцы матрицы
    \begin{equation*}
        P =
        \begin{bmatrix}
            1 & 4 & 5 & 8\\
            4 & 0 & 5 & 0
        \end{bmatrix}
    \end{equation*}
\end{problem}

Уравнение кривой Безье, построенной по $n+1$ точкам в $\mathbb{R}^2$ можно
записать в виде:
\begin{equation*}
    \begin{cases}
        x(t) = \sum_{k=0}^{n}{B_{n,k}(t) x_k}\\
        y(t) = \sum_{k=0}^{n}{B_{n,k}(t) y_k}\\
    \end{cases}
    \qquad
    B_{n,k}(t) = \binom{n}{k} (1-t)^{n-k} t^k.
\end{equation*}

Выпишем функции $B_{n,k}(t)$:
\begin{align*}
    B_{3,0}(t) &= \binom{3}{0} (1-t)^3 t^0 = (1-t)^3
    &
    B_{3,2}(t) &= \binom{3}{2} (1-t)^1 t^2 = 3t^2(1-t)\\
    B_{3,1}(t) &= \binom{3}{1} (1-t)^2 t^1 = 3t(1-t)^2
    &
    B_{3, 3}(t) &= \binom{3}{3} (1-t)^0 t^3 = t^3.\\
\end{align*}

Подставив $B_{n,k}(t)$ в написанные ранее формулы, получим следующие выражения
\begin{equation*}
    \begin{cases}
        x(t) = 4t^3 - 6t^2 + 9t + 1,\\
        y(t) = -19t^3 + 27t^2 - 12t + 4.
    \end{cases}
\end{equation*}

Ниже представлен код для построения кривой Безье для произвольного набора точек.
Также приведён построенный с помощью этого кода график. Аналогичный результат
достигается при использовании полученных параметрических формул.

\begin{figure}[hbt]
    \centering
    \includegraphics*[scale=1.0]{figures/ex4.pdf}
    \caption{Кривая Безье}
\end{figure}

\newpage
\input{ex4.tex}

% 5
\newpage
\begin{problem}
    Для многочлена $x^3 - 4x^2 + 4x - 5$ найти наилучшее приближение по
    max-норме многочленом степени $2$ на отрезке $[0, 4]$.
\end{problem}


% 6
\begin{problem}
    Оценить относительную погрешность приближённого решения $(1, 1)$ системы
    $Ax = b$ по нормам $|\cdot|_1$ с помощью числа обусловленности матрицы
    $A$, где
    \begin{equation*}
        A =
        \begin{pmatrix}
            2.95 & -0.07\\
            6.97 & -2.0
        \end{pmatrix}
        , \qquad b =
        \begin{pmatrix}
            3.11\\
            4.97
        \end{pmatrix}
    \end{equation*}
\end{problem}


% 7
\begin{problem}
    Построить многочлен степени $\leq 3$, аппроксимирующий функцию
    $f = \sqrt{5x + 5}$ на отрезке $[0, 6]$ по норме
    $|h|_T = \sqrt{\int_0^6{
        \frac{h^2(x)}{\sqrt{1 - (2x - 6)^2/36}}
        dx
    }}$.
\end{problem}