\problemset{Контрольная работа №2 (вариант 11)}

% 1
\begin{problem}
    Найти наилучшее приближение $A_1$ ранга $2$ матрицы $A$ по норме
    $||\cdot||_2$ и вычислить\\ $||A - A_1||_2$, где
    \begin{equation*}
        A =
        \begin{pmatrix}
            -8 & -42 & 9 & 40\\
            10 & 48 & -54 & -2\\
            -67 & -12 & 36 & -22
        \end{pmatrix}.
    \end{equation*}
\end{problem}


Сначала выполним сингулярное разложение $A = U \Sigma V^T$. Матрица $V$
состоит из собстенных векторов $A^TA$.
\begin{equation*}
    A^TA = \begin{pmatrix}
        4653 & 1620 & -3024 & 1134\\
        1620 & 4212 & -3402 & -1512\\
        -3024 & -3402 & 4293 & -324\\
        1134 & -1512 & -324 & 2088
    \end{pmatrix}
    \qquad
    V = \frac{1}{11}
    \begin{pmatrix}
        -6 & -6 & 7 & 0\\
        -6 & 6 & 0 & 7\\
        7 & 0 & 6 & 6\\
        0 & -7 & -6 & 6
    \end{pmatrix}
    \qquad
    \lambda = (9801, 4356, 1089, 0)
\end{equation*}
Корни из собственных значений $\lambda$ будут лежать на главной диагонали
матрицы $\Sigma$
\begin{equation*}
    \Sigma = \begin{pmatrix}
        99 & 0 & 0 & 0\\
        0 & 66 & 0 & 0\\
        0 & 0 & 33 & 0
    \end{pmatrix}
\end{equation*}
Т.~к. $AV = U\Sigma$, мы можем определить $U$
\begin{equation*}
    U = \frac{1}{3}
    \begin{pmatrix}
        1 & -2 & -2\\
        -2 & 1 & -2\\
        2 & 2 & -1
    \end{pmatrix}
\end{equation*}
Теперь, воспользовавшись теоремой Эккарта--Янга, найдём $A_1$
\begin{equation*}
    A_1 = U \Sigma_r V^T = U
    \begin{pmatrix}
        99 & 0 & 0 & 0\\
        0 & 66 & 0 & 0\\
        0 & 0 & 0 & 0
    \end{pmatrix}
    V^T =
    \begin{pmatrix}
        6 & -42 & 21 & 28\\
        24 & 48 & -42 & -14\\
        -60 & -12 & 42 & -28
    \end{pmatrix}
\end{equation*}
Погрешность приближения
\begin{equation*}
    ||A - A_1||_2 = ||\Sigma - \Sigma_r||_2 = 33
\end{equation*}


% 2
\newpage
\begin{problem}
    Оценить относительную погрешность приближенного решения $(1, 1)$ системы
    $Ax = b$ по нормам $|\cdot|_1$ и $|\cdot|_2$ с помощью числа обусловленности
    матрицы $A$, где
    \begin{equation*}
        A = \begin{pmatrix}
            4.99 & 0.02\\
            -4.83 & -8.01
        \end{pmatrix}
    ,\qquad
    b = \begin{pmatrix}
            5.0\\
            -12.98
        \end{pmatrix}
    \end{equation*}
\end{problem}


Очевидно, что решение $\hat{x} = (1, 1)$ получается при округлении $A$ и $b$ до
целочисленных значений. Таким образом
\begin{equation*}
    \hat{A} =
    \begin{pmatrix}
        5 & 0\\
        -5 & -8
    \end{pmatrix}
    \qquad
    \eps_A = \hat{A} - A =
    \begin{pmatrix}
        0.01 & -0.02\\
        -0.17 & 0.01
    \end{pmatrix}
    \qquad
    \hat{b} =
    \begin{pmatrix}
        5\\
        -13
    \end{pmatrix}
    \qquad
    \Delta{b} = \hat{b} - b =
    \begin{pmatrix}
        0\\
        -0.02
    \end{pmatrix}
\end{equation*}

Погрешность решения относительно некоторой нормы $||\cdot||$ определяется
выражением
\begin{equation*}
    \delta{x} \leq \frac{\kappa(A)}{1-\kappa(A)\delta{A}}(\delta{A}+\delta{b}),
\end{equation*}
где $\kappa(A) = ||A|| \; ||A^{-1}||$ -- число обусловленности матрицы $A$;
$\delta{A} = ||\eps_A|| / ||A||$, $\delta{b} = ||\Delta{b}|| / ||b||$. Обратная
матрица
\begin{equation*}
    A^{-1} = \frac{1}{|A|}
    \begin{pmatrix}
        -8.01 & -0.02\\
        4.83 & 4.99
    \end{pmatrix}
    = \frac{1}{39.87}
    \begin{pmatrix}
        8.01 & 0.02\\
        -4.83 & -4.99
    \end{pmatrix}
\end{equation*}

Погрешность по норме $||\cdot||_1$:
\begin{equation*}
    \delta{x} \leq
    \frac{9.82\cdot{0.32}}{1-9.82\cdot{0.32}\cdot{(0.18/9.82)}}
    \left(\frac{0.18}{9.82} + \frac{0.02}{17.98}\right)
    =
    \frac{3.16}{1 - 3.16\cdot{0.018}} \left(3.16 + 0.001\right)
    =
    0.065
\end{equation*}

Погрешность по норме $||\cdot||_2$ (наибольшее сингулярное число):
\begin{equation*}
    \delta{x} \leq
    \frac{9.79\cdot{0.25}}{1-9.79\cdot{0.25}\cdot{(0.17/9.78)}}
    \left(\frac{0.17}{9.78} + \frac{0.02}{13.91}\right)
    =
    0.047
\end{equation*}


% 3
\vspace{1em}
\begin{problem}
    Найти приближенно обратную матрицу к матрице $A$ и оценить погрешность
    приближения относительно равномерной нормы $||\cdot||_1$ если элементы
    матрицы $A$ известны с абсолютной погрешностью $0.01$.
    \begin{equation*}
        A \approx \begin{pmatrix}
            2 & -3\\
            8 & -7
        \end{pmatrix}
    \end{equation*}
\end{problem}


Если погрешность элементов матрицы $A$ равна $0.01$, то $||\eps_A||_1 = 0.02$.
Приближенное значение обратной матрицы, число обусловленности и относительное
возмущение:
\begin{equation*}
    A^{-1} = \frac{1}{10}
    \begin{pmatrix}
        -7 & 3\\
        -8 & 2
    \end{pmatrix}
    \qquad
    \kappa(A) = ||A||_1 \; ||A^{-1}||_1 =  10 \cdot \frac{15}{10} = 15
    \qquad
    \delta{A} = \frac{||\eps_A||_1}{||A||_1} = 0.002
\end{equation*}

Погрешность приближения
\begin{equation*}
    \delta{A^{-1}} = \frac{\kappa(A) \delta{A}}{1 - \kappa(A) \delta{A}}
    =
    \frac{15\cdot{0.002}}{1-15\cdot{0.002}} = \frac{0.03}{0.97} = 0.031
\end{equation*}


% 4
\newpage
\begin{problem}
    Найти самую влиятельную вершину в ориентированном графе с помощью алгоритма
    PageRank с коэффициентом ослабления $1 - \beta = 0.85$, где матрица
    смежности графа равна
    \begin{equation*}
        A = \begin{pmatrix}
            1 & 0 & 1 & 0 & 0\\
            0 & 1 & 1 & 0 & 0\\
            0 & 0 & 1 & 1 & 0\\
            0 & 0 & 1 & 1 & 0\\
            1 & 0 & 1 & 1 & 1
        \end{pmatrix}
    \end{equation*}
\end{problem}

Сначала составим матрицу $P$, которая отличается от матрицы смежности тем, что
сумма всех элементов, принадлежащих одному столбцу, равна $1$.
\begin{equation*}
    P = \begin{pmatrix}
        0.5 & 0 & 0.2 & 0 & 0\\
        0 & 1 & 0.2 & 0 & 0\\
        0 & 0 & 0.2 & 0.33 & 0\\
        0 & 0 & 0.2 & 0.33 & 0\\
        0.5 & 0 & 0.2 & 0.33 & 1
    \end{pmatrix}
\end{equation*}

Далее составим матрицу $P'$, которая является взвешенной суммой матриц $P$ и
$Q$ ($\forall i, j: q_{ij} = 1/n = 0.2$)
\begin{equation*}
    P' = (1 - \beta) P + \beta Q =
    \begin{pmatrix}
        0.455 & 0.03 & 0.2 & 0.03 & 0.03\\
        0.03 & 0.88 & 0.2 & 0.03 & 0.03\\
        0.03 & 0.03 & 0.2 & 0.313 & 0.03\\
        0.03 & 0.03 & 0.2 & 0.313 & 0.03\\
        0.455 & 0.03 & 0.2 & 0.313 & 0.88
    \end{pmatrix}
\end{equation*}

Возьмем начальное решение $x = (0.2, 0.2, 0.2, 0.2, 0.2)^T$ и применим алгоритм
\texttt{PageRank}, т.е. будем итерационно выполнять обновления
$x \leftarrow P'x$. Результаты приведены в таблице:
\begin{center}
    \begin{tabular}{c|c|c|c|c|c}
        № итерации $k$ & \multicolumn{5}{|c}{$x_k$}\\
        \hline
        0 & 0.2 & 0.2 & 0.2 & 0.2 & 0.2\\
        \hline
        1 & 0.149 & 0.234 & 0.121 & 0.121 & 0.121\\
        \hline
        2 & 0.114 & 0.249 & 0.085 & 0.085 & 0.467\\
        \hline
        3 & 0.093 & 0.256 & 0.068 & 0.068 & 0.514\\
        \hline
        4 & 0.081 & 0.260 & 0.061 & 0.061 & 0.537\\
        \hline
        5 & 0.075 & 0.261 & 0.058 & 0.058 & 0.549\\
        \hline
        10 & 0.069 & 0.262 & 0.055 & 0.055 & 0.559\\
        \hline
        100 & 0.069 & 0.262 & 0.054 & 0.054 & 0.560
    \end{tabular}
\end{center}
Видим, что самой влиятельной является 5 вершина.


% 5
\newpage
\begin{problem}
    Найти значение $f(A)$ функции $f(l) = e^{l+2}$, где
    \begin{equation*}
        A = \begin{pmatrix}
            -24 & 7 & -6\\
            -84 & 24 & -20\\
            36 & -10 & 10
        \end{pmatrix}
    \end{equation*}
\end{problem}

Найдём $r(l)$ -- остаток от деления $f(l)$ на аннулирующий многочлен матрицы
$A$. Для этого численно определим собственные значения этой матрицы:
$\lambda_1 = 6$, $\lambda_2 = \lambda_3 = 2$. В таком случае
\begin{equation*}
    r(l) = \alpha l^2 + \beta l + \gamma
\end{equation*}
подчиняется следующим условиям:
\begin{equation*}
    \begin{cases}
        r(\lambda_1) &= f(\lambda_1)\\
        r(\lambda_2) &= f(\lambda_2)\\
        r'(\lambda_2) &= f'(\lambda_2)
    \end{cases}
    \qquad \implies \qquad
    \begin{cases}
        36 \alpha + 6\beta + \gamma &= e^8\\
        4 \alpha + 2\beta + \gamma &= e^4\\
        4 \alpha + \beta &= e^4
    \end{cases}
\end{equation*}

Решение получившейся системы:
\begin{equation*}
    \begin{cases}
        \alpha = \frac{e^8 - 5e^4}{16} &= 169.248\\
        \beta = \frac{9e^4 - e^8}{4} &= -622.394\\
        \gamma = -\beta &= 622.394
    \end{cases}
\end{equation*}

Тогда
\begin{equation*}
    e^{A+2} = \alpha AA + \beta A + \gamma =
    \begin{pmatrix}
        -23028.7 & 5798.1 & -5743.5\\
        -69577.5 & 17503.6 & -17339.8\\
        34461.1 & -8669.9 & 8615.3
    \end{pmatrix}
\end{equation*}


% 6
\vspace{1em}
\begin{problem}
    Найти собственные значения методом вращений (метод Якоби) для матрицы
    \begin{equation*}
        A = \begin{pmatrix}
            4 & 1 & 1\\
            1 & 8 & 3\\
            1 & 3 & 8
        \end{pmatrix}
    \end{equation*}
\end{problem}

Первая итерация метода Якоби:
\begin{equation*}
    T_{ij} = T_{23} =
    \begin{pmatrix}
        1 & 0 & 0\\
        0 & 1/\sqrt{2} & -1/\sqrt{2}\\
        0 & 1/\sqrt{2} & 1/\sqrt{2}
    \end{pmatrix},
    \qquad
    A_1 = T_{23}^T A T_{23} =
    \begin{pmatrix}
        4 & \sqrt{2} & 0\\
        \sqrt{2} & 11 & 0\\
        0 & 0 & 5
    \end{pmatrix}
    \qquad
    T_1 = E T_{23} = T_{23}
\end{equation*}

Вторая итерация:
\begin{equation*}
    T_{ij} = T_{12} =
    \begin{pmatrix}
        0.982 & 0.191 & 0\\
        -0.191 & 0.982 & 0\\
        0 & 0 & 1
    \end{pmatrix},
    \qquad
    A_2 = T_{12}^T A_1 T_{12} =
    \begin{pmatrix}
        3.725 & 0 & 0\\
        0 & 11.275 & 0\\
        0 & 0 & 5
    \end{pmatrix}
     = \Lambda,
\end{equation*}
\begin{equation*}
    T_2 = T_1 T_{12} =
    \begin{pmatrix}
        0.982 & 0.191 & 0\\
        -0.135 & 0.694 & -0.707\\
        -0.135 & 0.694 & 0.707
    \end{pmatrix}
    = T
\end{equation*}
Диагональные элементы $\Lambda$ -- собственные числа, а соответствующие им
столбцы $T$ -- собственные векторы матрицы $A$.


% 7
\begin{problem}
    Решить задачу линейного программирования и найти ``теневые цены'', отвечающие
    каждому ограничению.
    \begin{equation*}
        16x_1 + 108x_2 + 24x_3 \to \text{min}
    \end{equation*}
    \begin{equation*}
        \begin{cases}
            -10x_1 + 6x_2 + 8x_3 \geq 4\\
            4x_1 + 6x_2 - 7x_3 \geq 2\\
            x_1 \geq 0; \; x_2 \geq 0; \; x_3 \geq 0
        \end{cases}
    \end{equation*}
\end{problem}

\ldots


% 8
\begin{problem}
    Решить систему линейных уравнений методом итераций, преобразовав, если
    нужно, систему.
    \begin{equation*}
        \begin{cases}
            22x + 5y + 4z &= 2\\
            2x + 26y + 2z &= 9\\
            1x + 4y + 23z &= 1
        \end{cases}
    \end{equation*}
    Определить номер итерации, после которой погрешность приближения по каждой
    координате не превосходит $0.01$ и найти соответствующее приближенное
    решение. За нулевое приближение принять вектор $x_0 = [0, 0, 0]^T$.
\end{problem}

Преобразуем нашу систему к виду $X = PX + b$ (здесь и далее $X = (x, y, z)^T$).
Для этого выразим $x$, $y$ и $z$ из 1, 2 и 3 уравнения, соответственно.
\begin{equation*}
    \begin{cases}
        x = -\frac{5}{22}y - \frac{2}{11}z + \frac{1}{11}\\
        y = -\frac{1}{13}x - \frac{1}{13}z + \frac{9}{26}\\
        z = -\frac{1}{23}x - \frac{4}{23}y + \frac{1}{23}
    \end{cases}
    \qquad
    P = \begin{pmatrix}
        0 & -{5/22} & -{2/11}\\
        -{1/13} & 0 & -{1/13}\\
        -{1/23} & -{4/23} & 0
    \end{pmatrix}
    \qquad
    b = \begin{pmatrix}
        {1/11}\\
        {9/26}\\
        {1/23}
    \end{pmatrix}
\end{equation*}

Нетрудно заметить, что $||P||_1 < 1$, соответственно итерационный метод должен
сходиться к истинному решению системы. В случае произвольной матричной нормы,
согласованной с векторной, число итераций определяется выражением
\begin{equation*}
    k =  \left \lceil \ln \left(\frac{1 - ||P||}{|X_1 - X_0|} \eps\right)
                      / \ln{||P||} \right \rceil,
\end{equation*}
где $\eps = |X_k - \hat{X}|$, a $X_1 - X_0 = b$ при $X_0 = (0, 0, 0)^T$.

Очевидно, что если погрешность приближения по $1$-норме не превосходит $0.01$,
то и приближение по каждой координате $\leq 0.01$. Тогда число итераций
\begin{equation*}
    k_1 =  \left\lceil \ln \left(\frac{1 - 0.401}{0.481} 0.01\right)
                       / \ln{0.401} \right \rceil
        = \lceil 4.8 \rceil = 5
\end{equation*}
Но такое же утверждение справедливо и для $2$-нормы, при этом число необходимых
итераций
\begin{equation*}
    k_2 =  \left\lceil \ln \left(\frac{1 - 0.328}{0.361} 0.01\right)
                       / \ln{0.328} \right \rceil
        = \lceil 3.6 \rceil = 4
\end{equation*}
оказывается меньше.

В таблице представлены полученные с помощью итерационного метода результаты.
Видно, что после $4$ итераций действительно достигается требуемая точность.
\begin{center}
\begin{tabular}{c|c|c|c}
    № итерации $k$ & $x_k$ & $y_k$ & $z_k$\\
    \hline
    0 & 0 & 0 & 0 \\ \hline
    1 & 0.091 & 0.346 & 0.043 \\ \hline
    2 & 0.004 & 0.336 & -0.021 \\ \hline
    3 & 0.018 & 0.347 & -0.015 \\ \hline
    4 & 0.015 & 0.345 & -0.017 \\ \hline
    \ldots & & & \\ \hline
    100 &  0.015 & 0.346 & -0.017\\
\end{tabular}
\end{center}


% 9
\begin{problem}
    Найти неявное выражение кривой $f(x, y) = 0$ по данной параметризации
    \begin{equation*}
        x = \frac{t}{t^2 + 2}
        \qquad
        y = \frac{t^2 + 1}{t^3 - t^2 + 1}
    \end{equation*}
\end{problem}

\ldots